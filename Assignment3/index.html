<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Major Studio Assignment #3</title>
		<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:100|PT+Serif|Playfair+Display|Raleway" rel="stylesheet">
		<link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:100|Playfair+Display" rel="stylesheet">
		<style type="text/css">

		body {
			background-color: #333132;
			color: #fff;
			font-family: 'PT Serif', serif;
			}

			h2, h3, h5 {
			text-align: center;
			color: #ddd;
		}

			text {
				fill: black;

			}

			a {
				color: #FFE17F;

			}

			h5 {
				color: #FFE17F;
				font-family: "IBM Plex Sans"

			}

			.container{
				max-width: 1000px;
				margin-left: auto;
				margin-right: auto;
				padding: 50px;
			}

			.sources{

			}

			/* Hide amCharts watermark */
			#mapdiv a, #barChartDiv a, #lineGraphDiv a{
				display:none!important;
			}

			#mapdiv {
				width		: 100%;
				height		: 500px;
				font-size	: 11px;
				display: inline-block;
			}

			#barChartDiv {
				width		: 100%;
				height		: 500px;
				font-size	: 11px;
				font-family: 'IBM Plex Sans', sans-serif;
				display: inline-block;
			}
			#barChartDiv text, #lineGraphDiv text {
				font-family: 'IBM Plex Sans', sans-serif;
				fill:#fff;
			}

			#lineGraphDiv {
				width		: 100%;
				height		: 500px;
				font-size	: 11px;
				font-family: 'IBM Plex Sans', sans-serif;

			}

			#barChartDiv path{
				/*
				SAMPLE:
					fill: #fff;
					stroke: #000;
				*/
			}



			#mapdiv #amcharts_pie_0,#mapdiv #amcharts_pie_1,#mapdiv #amcharts_pie_2,#mapdiv #amcharts_pie_3,#mapdiv #amcharts_pie_4,#mapdiv #amcharts_pie_5,#mapdiv #amcharts_pie_6,#mapdiv #amcharts_pie_7,#mapdiv #amcharts_pie_8,#mapdiv #amcharts_pie_9,#mapdiv #amcharts_pie_10{
				overflow:visible!important;
			}
			#mapdiv .amcharts-main-div{
				overflow:visible!important;
			}
			#mapdiv .amcharts-chart-div{
				overflow:visible!important;
			}
			#mapdiv .amcharts-chart-div .amcharts-balloon-div{
				overflow:visible!important;
			}
			#mapdiv .amcharts-chart-div .amcharts-balloon-div div{
				color:#000!important;
				background:#f4f4f4;
				padding:0;
				outline:solid 5px #f4f4f4;
			}


		</style>
		<script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
		<script src="https://www.amcharts.com/lib/3/pie.js"></script>
		<script src="https://www.amcharts.com/lib/3/ammap_amcharts_extension.js"></script>
		<script src="https://www.amcharts.com/lib/3/maps/js/continentsHigh.js"></script>
		<script src="https://www.amcharts.com/lib/3/plugins/export/export.min.js"></script>
		<link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all" />
		<script src="https://www.amcharts.com/lib/3/themes/light.js"></script>
		<script src="https://www.amcharts.com/lib/3/serial.js"></script>
		<script src="https://www.amcharts.com/lib/3/plugins/dataloader/dataloader.min.js"></script>
		<script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
		<script src="https://www.amcharts.com/lib/3/serial.js"></script>
		<script src="https://www.amcharts.com/lib/3/plugins/export/export.min.js"></script>
		<link rel="stylesheet" href="https://www.amcharts.com/lib/3/plugins/export/export.css" type="text/css" media="all" />
		<script src="https://www.amcharts.com/lib/3/themes/black.js"></script>
	</head>
	<body>
		<div class="container">
			<h2>Would dependable energy in health care facilities reduce maternal death rates in sub-Saharan Africa?</h2>
			<h5> By Simone Betito </h5>
		</div>

		<div class="container">
			<h4>
				<p>
					Through the lens of SDG-5 (Gender Equality), this visualization examines the importance of dependable energy in healthcare facilities and its role in reproductive care in sub-Saharan Africa. It also explores the direct correlation between maternal mortality rates and a lack of electricity in healthcare facilities in sub-Saharan Africa</h4>
				</p>
				<p>
					Without dependable energy in healthcare facilities, women experience a range of complications including but not limited to, giving birth in the dark without access to lifesaving devices requiring electricity.
				</p>
				<p>
					Iniatives that focus on investing in dependable energy in this area will have a direct impact in saving women's lives.
				</p>
		</div>

		<div class="container">
			<h3>In sub-Saharan Africa, 1 in 36 women will die from Maternal Conditions.</h3>
			<h4>The chart below visualizes the discrepancy between Maternal Mortality in sub-Saharan Africa and the world. In 2015, 201,000 women in that region died from complications relating to giving birth.</h4>

			<div id="barChartDiv"></div>
		</div>

		<div class="container">
			<h3>Here's the energy breakdown of healthcare facilities in 11 Sub-Saharan countries</h3>
			<h4><p>The map below looks at 11 Sub-Saharan countries (Ethiopia, The Gambia, Ghana, Kenya, Namibia, Nigeria, Rwanda, Sierra Leone, Tanzania, Uganda, Zambia) and how their health facilities are powered, either by generator only, central, solar or other supply, or no electricity at all. </p>
				<p>In 10 out of the 11 countries examined, there is still a portion of healthcare facilities that are operating without electricity. </p>
			</h4>
			<div id="mapdiv"></div>
		</div>

		<div class="container">
			<h3>There is a direct correlation between a lack of energy in healthcare facilities and expecting mothers dying</h3>
			<h4>This chart compares the percentage of healthcare facilities without electricity and the percentage of maternal deaths per women in childbearing years in a specific country. As the percentage of healthcare facilities without electricity peaks, so does an increase in deaths. A pattern is observable.</h4>
			<div id="lineGraphDiv"></div>
		</div>

		<div class="container ">
			<h3>How You Can Help</h3>
			<h4>
				<p>
					Financial investment for the electrification of health centers in sub-Saharan Africa will mean life saving vaccines and care for women. The UN lists a number of devices essential in reproductive health care requiring electricity.
				</p>
			</h4>
		</div>

		<div class="container sources">
 		<hr>
			<h3>Sources</h3>

				<h4>
					<p>ADAIR-ROHANI, H., ZUKOR, K., BONJOUR, S., WILBURN, S., KUESEL, A. C., HEBERT, R. AND FLETCHER, E. R.
				Limited electricity access in health facilities of sub-Saharan Africa: a systematic review of data on electricity access, sources, and reliability
				<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4168575/">Available Here</a> </p>
				<p>Thelancet.com. <a href="https://www.thelancet.com/action/showFullTableHTML?isHtml=true&tableId=tbl1&pii=S2214-109X%2817%2930488-6">Available Here</a></p>
				<p>UNICEF Data. Maternal Mortality. <a href="https://data.unicef.org/topic/maternal-health/maternal-mortality/">Available Here</a></p>
				<p></p>
			</h4>
		</div>

		<br>
		<br>






		<script type="text/javascript">

			// Create the map - load the data from external resource
			AmCharts.loadFile("https://gavamedia.com/TEMP/assignment_3_data.json", {}, function(response) {

				// Convert the data string to an object
				let data = JSON.parse(response);


				// Create the map
				var map = AmCharts.makeChart("mapdiv", {
					"type": "map",
					"theme": "light",
					"projection": "winkel3",

					// Load the data object
					"dataProvider" : data,

					// Add legend
					/*
						"#f47b20" - No Electricity (%)
						"#fff1ca" - Generator Only (%)
						"#ffe180" - Central, Solar or Other Supply (%)
						"#e8e3db" - no data?
						https://www.amcharts.com/demos/logarithmic-scale/
					*/

					"legend": {
						"width": "100%",
						"marginRight": 27,
						"marginLeft": 27,
						"equalWidths": false,
						"backgroundAlpha": 0.5,
						"backgroundColor": "#FFFFFF",
						"borderColor": "#ffffff",
						"borderAlpha": 1,
						"top": 450,
						"left": 0,
						"horizontalGap": 10,
						"data": [ {
							"title": "No Electricity (%)",
							"color": "#f47b20"
						}, {
							"title": "Generator Only (%)",
							"color": "#fff1ca"
						}, {
							"title": "Central, Solar or Other Supply (%)",
							"color": "#ffe180"
						}, {
							"title": "No Data",
							"color": "#e8e3db"
						} ]
					},

					// Custom balloon appearance
					"balloon": {
						"backgroundAlpha": 0,
						"fillColor": "#FF0000"
					},

					// Event executed when map is zoomed/moved/loaded
					"listeners": [{
						"event": "positionChanged",
						"method": updateCustomMarkers
					}]
				});

			});

			// Create the bar graph chart - load the data from external resource
			AmCharts.loadFile("https://gavamedia.com/TEMP/barChart.csv", {}, function(response) {

				// Parse CSV
				var data = AmCharts.parseCSV( response, { "useColumnNames": true } );

				var chart = AmCharts.makeChart( "barChartDiv", {
					"type": "serial",
					"theme": "black",
					// // "titles": [{
					// // 	"text": "In Sub-Saharan Africa, 1 in 36 women will die from Maternal Conditions",
					// // 	"size": 15
					// }],
					"dataProvider": data,
					"valueAxes": [ {
						"gridColor": "#FFFFFF",
						"color" : "#FFE17F",
						"gridAlpha": 0.2,
						"dashLength": 0
					} ],
					"gridAboveGraphs": true,
					"startDuration": 1,
					"graphs": [ {
						"balloonText": "[[category]]: <b>[[value]]</b>",
						"colorField": "color",
						"fillAlphas": 0.8,
						"lineAlpha": 0.2,
						"type": "column",
						"valueField": "Number of Maternal Deaths (2015)"
					} ],
					"chartCursor": {
						"categoryBalloonEnabled": false,
						"cursorAlpha": 0,
						"zoomable": false
					},
					"categoryField": "Region",
					"categoryAxis": {
						"gridPosition": "start",
						"gridAlpha": 0,
						"tickPosition": "start",
						"tickLength": 20
					}
				} );

				chart.color = "#000000";

			});


			// Create the line graph chart - load the data from external resource
			AmCharts.loadFile("https://gavamedia.com/TEMP/lineChart.csv", {}, function(response) {

				// Parse CSV
				var data = AmCharts.parseCSV( response, { "useColumnNames": true } );

				var lineGraphChart = AmCharts.makeChart( "lineGraphDiv", {
					"type": "serial",
					"addClassNames": true,
					"theme": "black",
					// "titles": [{
					// 	"text": "The correlation between the lack of electricity in healthcare facilities and maternal deaths",
					// 	"size": 15
					// }],
					"autoMargins": false,
					"marginLeft": 30,
					"marginRight": 8,
					"marginTop": 10,
					"marginBottom": 26,
					"balloon": {
						"adjustBorderColor": false,
						"horizontalPadding": 10,
						"verticalPadding": 8,
						"color": "#ffffff"
					},
					"dataProvider": data,
					"valueAxes": [ {
						"axisAlpha": 0,
						"position": "left",
						"logarithmic": true
					}, {
						"logarithmic": true
					}],
					"startDuration": 1,
					"graphs": [ {
						"balloonText": "<span style='font-size:12px;'>[[title]] in [[category]]:<br><span style='font-size:20px;'>[[value]]%</span> [[additional]]</span>",
						"bullet": "round",
						"lineThickness": 3,
						"fillAlphas": 0,
						"lineAlpha": 1,
						"title": "% of Maternal Deaths per Women in Childbearing Years",
						"valueField": "% of Maternal Deaths per Women in Childbearing Years"
					}, {
						"id": "graph2",
						"balloonText": "<span style='font-size:12px;'>[[title]] in [[category]]:<br><span style='font-size:20px;'>[[value]]%</span> [[additional]]</span>",
						"bullet": "round",
						"lineThickness": 3,
						"fillAlphas": 0,
						"lineAlpha": 1,
						"title": "% of Health Facilities With No Electricity",
						"valueField": "% of All Health Facilities With No Electricity"
					} ],
					"categoryField": "Country",
					"categoryAxis": {
						"gridPosition": "start",
						"axisAlpha": 0,
						"tickLength": 0
					},
					"export": {
						"enabled": true
					}
				} );

			});



			/**
			* Creates and positions custom markers (pie charts)
			*/
			function updateCustomMarkers(event) {
				// get map object
				var map = event.chart;

				// go through all of the images
				for (var x = 0; x < map.dataProvider.images.length; x++) {

					// get MapImage object
					var image = map.dataProvider.images[x];

					// Is it a Pie?
					if (image.pie === undefined) continue;

					// create id
					if (image.id === undefined) image.id = "amcharts_pie_" + x;

					// Add theme
					if ("undefined" == typeof image.pie.theme) image.pie.theme = map.theme;


					// Make pies fill all the chart area
					image.pie.autoMargins = false;
					image.pie.radius = "30%";
					image.width = 80;
					image.height = 80;


					// Click & hover events for each pie chart
					image.pie.listeners = [{
						"event": "clickSlice",
						"method": clickedPie
					}, {
						"event": "rollOverSlice",
						"method": clickedPie
					}];


					// check if it has corresponding HTML element
					if ("undefined" == typeof image.externalElement) image.externalElement = createCustomMarker(image);

					// reposition the element accoridng to coordinates
					var xy = map.coordinatesToStageXY(image.longitude, image.latitude);
					image.externalElement.style.top = xy.y + "px";
					image.externalElement.style.left = xy.x + "px";
					image.externalElement.style.marginTop = Math.round(image.height / -2) + "px";
					image.externalElement.style.marginLeft = Math.round(image.width / -2) + "px";
				}
			}


			/**
			* Creates a custom map marker - a div for container and a
			* pie chart in it
			*/
			function createCustomMarker(image) {
				// Create chart container
				var holder = document.createElement("div");
				holder.id = image.id;
				holder.title = image.title;
				holder.style.position = "absolute";
				holder.style.width = image.width + "px";
				holder.style.height = image.height + "px";

				// Append the chart container to the map container
				image.chart.chartDiv.appendChild(holder);

				// Create a pie chart
				var chart = AmCharts.makeChart(image.id, image.pie);

				return holder;
			}



			function clickedPie(e) {

				// Toggle showing or hiding barChartDiv and lineGraphDiv
				// var	barChartDiv = document.getElementById("barChartDiv");
				// var	lineGraphDiv = document.getElementById("lineGraphDiv");
				//
				// if (barChartDiv.style.display == "none") {
				// 	barChartDiv.style.display = "inline-block";
				// 	lineGraphDiv.style.display = "none";
				// }
				// else {
				// 	barChartDiv.style.display = "none";
				// 	lineGraphDiv.style.display = "inline-block";
				// }
			}
		</script>

	</body>
</html>
